#!/bin/bash

# This script provides the main interface for interacting with the command line utilities used for
# starting and configuring the Live Lightshow.
#
# Arguments:
# <subcommand> possible values: *see below*
#
# Return status:
# 1: <subcommand> was invalid
# otherwise: $? of the given subcommand


#-Preliminaries---------------------------------#


# This will be overwritten upon installation.
# APP-DIRECTORY
readonly app_directory="$(cd "$(dirname "${BASH_SOURCE[0]}")" &>/dev/null && pwd)/.."

# Imports lookup utilities.
. "$app_directory/Utilities/lookup.sh"


#-Main------------------------------------------#


# Binds the subcommand and shifts the rest of the command line arguments to be passable to the
# subcommand.
readonly subcommand=$1
shift

# Runs the script corresponding to the given subcommand, or prints an error message and returns on
# failure if the given subcommand was invalid.
case "$subcommand" in
   initialize)
      "$app_directory/Command Line Interface/push_program.sh" || exit $?
      "$app_directory/Configuration/Scripts/reindex_static.sh" ;;
   start)
      "$app_directory/Command Line Interface/start_lightshow.sh" ;;
   configure)
      "$app_directory/Configuration/Scripts/configure_server_instance.sh" "$@";;
   save-configuration)
      ;; # TODO: Implement.
   reindex)
      "$app_directory/Configuration/Scripts/reindex_static.sh" ;;
   directory)
      echo "$app_directory" ;;
   *)
      echo -e "$(text_for_ lightshow-usage)"
      exit 1 ;;
esac
